const MongoClient = require('mongodb').MongoClient;
const mongoClient = new MongoClient("mongodb://localhost:27017", {useNewUrlParser: true, useUnifiedTopology: true});



var DB = {
	insert: function(table, d, callbak){
		var data = [];
		if (typeof d != 'object') return false;
		if (d.length) data = d; else data.push(d);

		var collection = this.db.collection(table);
		collection.insertMany(data, function(err, res){
			callbak(err, res);
		});
	},
	delete: function(){},
	update: function(){},
	select: function(){},
	init: function(dbname) {
		var self = this;
		mongoClient.connect(function(err, client){
			self.client = client;
			self.db = self.client.db(dbname);
		});		
	}
};

module.exports = DB;