/*
- объявляем константу http
- присваиваем (в виде ссылки) глобальный модуль http
- модуль http отвечает за входящие http запросы
*/
const http = require("http");

/*
- объявляем объект router в виде константы
- отвечает за маршрутизацию входящих http запросов как http://localhost:8888/users, http://localhost:8888/contacts
- маршрутизация — это передача входящих запросов в соответствующе обработчики (контроллеры)
- присваиваем (в виде ссылки) объект router экспортированной в модуле "node_modules/router/index.js"
*/
const router = require("router");

/*
- объявляем объект server в виде константы
- метод connect создает и запускает наш сервер и начинает слушать входящие http запросы через порт 8888 
- request - это входящие запросы
- response - это ответ клиенту инициировавший запрос
- в дальнейшем ссылка на request и response передается в router при вызове метода route.init
- метод connect вызывается с файла node_server\index.js (точка входа проекта)
- метод connect запускается только один раз при запуске проекта (node_server>node index)
*/
const server = {
	connect: function() {
		http.createServer(function(request, response) {
			router.route.init(request, response);
		}).listen(8888);
		console.log('Is running ...')
	}
};

/*
- module - это текущий контекст 
- module.parent == null - это признак того, что модуль вызывается напрямую
- module.parent != null - это признак того, что модуль импортируется с другого модуля
- запускаем server.connect(), если модуль вызывается напрямую
- экспортируем если импортируется с другого модуля
*/
if (module.parent == null) {
	server.connect();
} else {
	module.exports = server;
}
